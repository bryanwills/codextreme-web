---
import "@/styles/optimizer.css";
import BaseLayout from "@/layouts/BaseLayout.astro";
import TweakSection from "@/components/TweakSection.astro";

import { languageList } from "@/i18n/ui";
import { useTranslations } from "@/i18n/utils";
import { networkTweaks } from "@/data/networkTweaks";
import { memoryTweaks } from "@/data/memoryTweaks";
import { gpuTweaks } from "@/data/gpuTweaks";
import { windowsFeaturesTweaks } from "@/data/windowsFeaturesTweaks";
import { firewallSecurityTweaks } from "@/data/firewallSecurityTweaks";
import { nagleAlgorithmTweaks } from "@/data/nagleAlgorithmTweaks";
import { networkThrottlingTweaks } from "@/data/networkThrottlingTweaks";
import { systemResponsivenessTweaks } from "@/data/systemResponsivenessTweaks";
import { latencyAndTimersTweaks } from "@/data/latencyAndTimersTweaks";
import {
  TWEAK_CATEGORIES,
  CATEGORY_ICONS,
  CATEGORY_COLORS,
} from "@/data/tweakCategories";

export function getStaticPaths() {
  return TWEAK_CATEGORIES.map((category) => ({
    params: { category },
  }));
}

const currentLang = Astro.currentLocale || "es";
const t = useTranslations(currentLang as keyof typeof languageList);

const { category } = Astro.params;
const categoryColors_current =
  CATEGORY_COLORS[category as keyof typeof CATEGORY_COLORS];
const categoryIcon = CATEGORY_ICONS[category as keyof typeof CATEGORY_ICONS];

if (!category || !categoryColors_current || !categoryIcon) {
  return new Response("Not found", { status: 404 });
}

// Obtener los datos de tweaks según la categoría
let tweaksData: any = null;
if (category === "network") {
  tweaksData = networkTweaks;
} else if (category === "memory") {
  tweaksData = memoryTweaks;
} else if (category === "gpu") {
  tweaksData = gpuTweaks;
} else if (category === "windows_features") {
  tweaksData = windowsFeaturesTweaks;
} else if (category === "firewall_security") {
  tweaksData = firewallSecurityTweaks;
} else if (category === "nagle_algorithm") {
  tweaksData = nagleAlgorithmTweaks;
} else if (category === "network_throttling") {
  tweaksData = networkThrottlingTweaks;
} else if (category === "system_responsiveness") {
  tweaksData = systemResponsivenessTweaks;
} else if (category === "latency_timers") {
  tweaksData = latencyAndTimersTweaks;
}

const tweaks = currentLang === "es" ? tweaksData?.es : tweaksData?.en;
const categoryTitle = t(`optimizer.sections.${category}` as any);
---

<BaseLayout title={`${categoryTitle} - ${t("optimizer.title")} - CodeXtremeOS`}>
  <!-- Hero Section -->
  <section
    class="relative bg-gradient-to-br from-[#1A1A1A] text-white py-24 overflow-hidden"
  >
    <div class="container mx-auto text-center px-4 relative z-10">
      <div class="max-w-3xl mx-auto">
        <a
          href="/es/optimizer"
          class="text-blue-400 hover:text-blue-300 mb-4 inline-block"
        >
          ← {t("optimizer.title")}
        </a>
        <h1
          class="text-5xl md:text-6xl font-bold mb-6 animate-fade-in [text-shadow:_0_4px_12px_rgb(0_0_0_/_30%)]"
        >
          <span
            class={`bg-clip-text text-transparent bg-gradient-to-r ${categoryColors_current.textColor}`}
          >
            <span class="mr-2">{categoryIcon}</span>
            {categoryTitle}
          </span>
        </h1>
        <p
          class="text-xl md:text-2xl mb-8 animate-fade-in delay-150 bg-white/10 backdrop-blur-sm px-6 py-3 rounded-full inline-block"
        >
          {t("optimizer.hero_description")}
        </p>
      </div>
    </div>
  </section>

  <!-- Sección Principal -->
  <main
    class="bg-gradient-to-br from-[#F4F4F4] to-[#eaeaea] dark:from-[#1A1A1A] py-16 relative"
  >
    <div class="container mx-auto px-4">
      {
        tweaks ? (
          <TweakSection
            tweaks={tweaks}
            title={categoryTitle}
            icon={categoryIcon}
            color={categoryColors_current.color}
            textColor={categoryColors_current.textColor}
          />
        ) : (
          <div class="bg-yellow-100 dark:bg-yellow-900 border border-yellow-400 dark:border-yellow-600 rounded-lg p-6 text-center">
            <p class="text-yellow-800 dark:text-yellow-200">
              Contenido para {categoryTitle} próximamente...
            </p>
          </div>
        )
      }
    </div>
  </main>
</BaseLayout>
